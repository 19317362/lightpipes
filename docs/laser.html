<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Laser examples. &#8212; LightPipes for Python 1.1.2 documentation</title>
    
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.1.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Focus of a lens." href="foclens.html" />
    <link rel="prev" title="Non-diffractive Bessel beam." href="besselbeam.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="foclens.html" title="Focus of a lens."
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="besselbeam.html" title="Non-diffractive Bessel beam."
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">LightPipes for Python 1.1.2 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="laser-examples">
<h1>Laser examples.<a class="headerlink" href="#laser-examples" title="Permalink to this headline">¶</a></h1>
<div class="section" id="laser-simulation-stable-laser-resonator">
<span id="index-0"></span><h2>Laser simulation, stable laser resonator.<a class="headerlink" href="#laser-simulation-stable-laser-resonator" title="Permalink to this headline">¶</a></h2>
<p>A typical laser consists of two (concave or convex) mirrors separated some distance and a gain medium mostly based on
stimulated emission. One (or both) of the mirrors is partly transmissive and when the
mirrors are well aligned and the losses are below some maximum the radiation field inside the
resonator will grow starting from noise by spontaneous emission as a function of the number of round trips. The laser intensity will be structured in
a number of resonator modes depending on the wavelength, the curvatures of and the distance between the mirrors
and especially the diameter of an intra-cavity aperture.</p>
<div class="figure" id="id1">
<img alt="_images/stab_laser.png" src="_images/stab_laser.png" />
<p class="caption"><span class="caption-text">Laser resonator with gain.</span></p>
</div>
<p>In the python script below a number of parameters can be adjusted which allows the study of several
important features of a laser. In the movie we show Q-switching to generate short high intensity pulses
by changing the reflectivity of the outcoupling mirror, operation on high-order transversal modes by opening
the aperture, changing the resonator g-parameters to study the stability criterion,
injection of a high-order Gauss-Hermite mode and the effect of thin wires inside the resonator.</p>
<iframe width="560" height="315" src="_static/laser.m4v" frameborder="0" allowfullscreen></iframe><p><a class="reference download internal" href="_downloads/laser_simulation.py" download=""><code class="xref download docutils literal"><span class="pre">(Download</span> <span class="pre">source</span> <span class="pre">code)</span></code></a></p>
<div class="literal-block-wrapper docutils container" id="laser-simulation">
<div class="code-block-caption"><span class="caption-text">laser_simulation.py</span><a class="headerlink" href="#laser-simulation" title="Permalink to this code">¶</a></div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python</span>
<span class="kn">from</span> <span class="nn">matplotlib.backends.backend_tkagg</span> <span class="k">import</span> <span class="n">FigureCanvasTkAgg</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">version_info</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">Tkinter</span> <span class="k">import</span> <span class="o">*</span>
    <span class="kn">import</span> <span class="nn">Tkinter</span> <span class="k">as</span> <span class="nn">Tk</span>
<span class="k">else</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">tkinter</span> <span class="k">import</span> <span class="o">*</span>
    <span class="kn">import</span> <span class="nn">tkinter</span> <span class="k">as</span> <span class="nn">Tk</span>
<span class="kn">from</span> <span class="nn">LightPipes</span> <span class="k">import</span> <span class="o">*</span>

<span class="n">root</span> <span class="o">=</span> <span class="n">Tk</span><span class="o">.</span><span class="n">Tk</span><span class="p">()</span>
<span class="n">root</span><span class="o">.</span><span class="n">wm_title</span><span class="p">(</span><span class="s2">&quot;Laser with stable resonator&quot;</span><span class="p">)</span>
<span class="n">root</span><span class="o">.</span><span class="n">wm_protocol</span><span class="p">(</span><span class="s2">&quot;WM_DELETE_WINDOW&quot;</span><span class="p">,</span> <span class="n">root</span><span class="o">.</span><span class="n">quit</span><span class="p">)</span>
<span class="n">power</span><span class="o">=</span><span class="p">[]</span>
<span class="n">roundtrip</span><span class="o">=</span><span class="mi">0</span>

<span class="n">wavelength</span><span class="o">=</span><span class="mi">10600</span><span class="o">*</span><span class="n">nm</span><span class="p">;</span>
<span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="o">*</span><span class="n">mm</span><span class="p">;</span>
<span class="n">N</span><span class="o">=</span><span class="mi">100</span><span class="p">;</span> <span class="n">N2</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="n">Isat</span><span class="o">=</span><span class="mi">131</span><span class="o">*</span><span class="n">W</span><span class="o">/</span><span class="n">cm</span><span class="o">/</span><span class="n">cm</span><span class="p">;</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.0067</span><span class="o">/</span><span class="n">cm</span><span class="p">;</span> <span class="n">Lgain</span><span class="o">=</span><span class="mi">30</span><span class="o">*</span><span class="n">cm</span><span class="p">;</span>

<span class="n">f1</span><span class="o">=</span><span class="mf">2.0</span><span class="o">*</span><span class="n">m</span>
<span class="n">f2</span><span class="o">=</span><span class="mi">5</span><span class="o">*</span><span class="n">m</span>

<span class="n">L</span><span class="o">=</span><span class="mi">30</span><span class="o">*</span><span class="n">cm</span>
<span class="n">T</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
<span class="n">Reflect</span><span class="o">=</span><span class="mf">0.9</span><span class="p">;</span>
<span class="n">w0</span><span class="o">=</span><span class="mf">2.4</span><span class="o">*</span><span class="n">mm</span>
<span class="n">n</span><span class="o">=</span><span class="mi">10</span><span class="p">;</span>
<span class="n">tx</span><span class="o">=</span><span class="mf">0.00</span><span class="o">*</span><span class="n">mrad</span><span class="p">;</span>
<span class="n">ty</span><span class="o">=</span><span class="mf">0.00</span><span class="o">*</span><span class="n">mrad</span><span class="p">;</span>
<span class="n">xwire</span><span class="o">=</span><span class="mf">10.0</span><span class="o">*</span><span class="n">mm</span>
<span class="n">ywire</span><span class="o">=</span><span class="mf">10.0</span><span class="o">*</span><span class="n">mm</span>
<span class="n">dt</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">L</span><span class="o">/</span><span class="mf">2.998</span><span class="o">*</span><span class="mf">1e-8</span>
<span class="n">fig</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">9</span><span class="p">))</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">211</span><span class="p">)</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">212</span><span class="p">)</span>

<span class="n">canvas</span> <span class="o">=</span> <span class="n">FigureCanvasTkAgg</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">master</span><span class="o">=</span><span class="n">root</span><span class="p">)</span>
<span class="n">canvas</span><span class="o">.</span><span class="n">_tkcanvas</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="n">Tk</span><span class="o">.</span><span class="n">LEFT</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">Tk</span><span class="o">.</span><span class="n">BOTH</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">v</span><span class="o">=</span><span class="n">StringVar</span><span class="p">()</span>
<span class="n">F</span><span class="o">=</span><span class="n">Begin</span><span class="p">(</span><span class="n">size</span><span class="p">,</span><span class="n">wavelength</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">TheExample</span><span class="p">():</span>
    <span class="c1">#start_time=time.time()</span>
    <span class="k">global</span> <span class="n">F</span><span class="p">,</span><span class="n">f1</span><span class="p">,</span><span class="n">f2</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="n">w0</span><span class="p">,</span><span class="n">roundtrip</span>
    <span class="k">global</span> <span class="n">Reflect</span>
    <span class="n">w0</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">scale_w0</span><span class="o">.</span><span class="n">get</span><span class="p">())</span><span class="o">*</span><span class="n">mm</span><span class="o">/</span><span class="mi">2</span>
    <span class="n">xwire</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">scalexwire</span><span class="o">.</span><span class="n">get</span><span class="p">())</span><span class="o">*</span><span class="n">mm</span>
    <span class="n">ywire</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">scaleywire</span><span class="o">.</span><span class="n">get</span><span class="p">())</span><span class="o">*</span><span class="n">mm</span>
    <span class="n">f1</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">scale_f1</span><span class="o">.</span><span class="n">get</span><span class="p">()</span><span class="o">*</span><span class="n">cm</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
    <span class="n">f2</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">scale_f2</span><span class="o">.</span><span class="n">get</span><span class="p">()</span><span class="o">*</span><span class="n">cm</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
    <span class="n">L</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">scale_L</span><span class="o">.</span><span class="n">get</span><span class="p">())</span><span class="o">*</span><span class="n">cm</span>
    <span class="n">Reflect</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">scale_Reflect</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
    <span class="n">tx</span><span class="o">=-</span><span class="nb">float</span><span class="p">(</span><span class="n">scale_tx</span><span class="o">.</span><span class="n">get</span><span class="p">())</span><span class="o">*</span><span class="n">mrad</span>
    <span class="n">ty</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">scale_ty</span><span class="o">.</span><span class="n">get</span><span class="p">())</span><span class="o">*</span><span class="n">mrad</span>
    <span class="n">alpha</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">scale_gain</span><span class="o">.</span><span class="n">get</span><span class="p">())</span><span class="o">/</span><span class="n">cm</span>
    <span class="n">F</span><span class="o">=</span><span class="n">RandomIntensity</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">(),</span><span class="mf">1e-8</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
    <span class="n">F</span><span class="o">=</span><span class="n">CircAperture</span><span class="p">(</span><span class="n">w0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
    <span class="n">F</span><span class="o">=</span><span class="n">RectScreen</span><span class="p">(</span><span class="n">size</span><span class="p">,</span><span class="mf">0.2</span><span class="o">*</span><span class="n">mm</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="n">ywire</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
    <span class="n">F</span><span class="o">=</span><span class="n">RectScreen</span><span class="p">(</span><span class="mf">0.2</span><span class="o">*</span><span class="n">mm</span><span class="p">,</span><span class="n">size</span><span class="p">,</span><span class="n">xwire</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
    <span class="n">Iw</span><span class="o">=</span><span class="n">Intensity</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
    <span class="n">F</span><span class="o">=</span><span class="n">Lens</span><span class="p">(</span><span class="n">f2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">F</span><span class="p">);</span>
    <span class="n">F</span><span class="o">=</span><span class="n">Forvard</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="n">F</span><span class="p">);</span> <span class="n">F</span><span class="o">=</span><span class="n">Gain</span><span class="p">(</span><span class="n">Isat</span><span class="p">,</span><span class="n">alpha</span><span class="p">,</span><span class="n">Lgain</span><span class="p">,</span><span class="n">F</span><span class="p">);</span>
    <span class="n">F</span><span class="o">=</span><span class="n">Lens</span><span class="p">(</span><span class="n">f1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">F</span><span class="p">);</span>
    <span class="n">F</span><span class="o">=</span><span class="n">Tilt</span><span class="p">(</span><span class="n">tx</span><span class="p">,</span><span class="n">ty</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
    <span class="n">F</span><span class="o">=</span><span class="n">Forvard</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="n">F</span><span class="p">);</span> <span class="n">F</span><span class="o">=</span><span class="n">Gain</span><span class="p">(</span><span class="n">Isat</span><span class="p">,</span><span class="n">alpha</span><span class="p">,</span><span class="n">Lgain</span><span class="p">,</span><span class="n">F</span><span class="p">);</span>
    <span class="n">F</span><span class="o">=</span><span class="n">IntAttenuator</span><span class="p">(</span><span class="n">Reflect</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
    <span class="n">P</span><span class="o">=</span><span class="n">Power</span><span class="p">(</span><span class="n">F</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">Reflect</span><span class="p">)</span><span class="o">*</span><span class="n">size</span><span class="o">/</span><span class="n">N</span><span class="o">*</span><span class="n">size</span><span class="o">/</span><span class="n">N</span>
    <span class="n">power</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">P</span><span class="p">);</span> <span class="n">roundtrip</span><span class="o">=</span><span class="n">roundtrip</span><span class="o">+</span><span class="mi">1</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">roundtrip</span><span class="o">&gt;</span><span class="mi">500</span><span class="p">):</span>
        <span class="n">power</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">Iout</span><span class="o">=</span><span class="n">Isat</span><span class="o">*</span><span class="p">(</span><span class="n">alpha</span><span class="o">*</span><span class="n">Lgain</span><span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">Reflect</span><span class="p">))</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">w0</span><span class="o">*</span><span class="n">w0</span>

    <span class="n">ax1</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

    <span class="n">g1</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="n">L</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">f1</span><span class="p">);</span>
    <span class="n">g2</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="n">L</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">f2</span><span class="p">);</span>
    <span class="n">g</span><span class="o">=</span><span class="n">g1</span><span class="o">*</span><span class="n">g2</span>
    <span class="n">v</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>  <span class="s2">&quot;Power=</span><span class="si">%5.3f</span><span class="s2"> W</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">%</span> <span class="n">P</span><span class="o">+</span>
            <span class="s2">&quot;g1 = </span><span class="si">%5.3f</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">%</span><span class="n">g1</span><span class="o">+</span>
            <span class="s2">&quot;g2 = </span><span class="si">%5.3f</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">%</span><span class="n">g2</span><span class="o">+</span>
            <span class="s2">&quot;g  = </span><span class="si">%5.3f</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">%</span><span class="n">g</span>
            <span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">Iw</span><span class="p">);</span> <span class="n">ax1</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">);</span> <span class="n">ax1</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;laser mode&#39;</span><span class="p">)</span> 
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">power</span><span class="p">);</span> <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">);</span> <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">500</span><span class="p">)</span>
    <span class="n">s</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%3.1f</span><span class="s1"> ns/div&#39;</span><span class="o">%</span> <span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">L</span><span class="o">/</span><span class="mf">2.988</span><span class="o">*</span><span class="mf">1000.0</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">s</span><span class="p">);</span> <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;power [W]&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span>
        <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span>          <span class="c1"># changes apply to the x-axis</span>
        <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span>      <span class="c1"># both major and minor ticks are affected</span>
        <span class="n">bottom</span><span class="o">=</span><span class="s1">&#39;on&#39;</span><span class="p">,</span>      <span class="c1"># ticks along the bottom edge are off</span>
        <span class="n">top</span><span class="o">=</span><span class="s1">&#39;on&#39;</span><span class="p">,</span>         <span class="c1"># ticks along the top edge are off</span>
        <span class="n">labelbottom</span><span class="o">=</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">canvas</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="c1">#print(&quot;Execution time: --- %4.2f seconds ---&quot; % (time.time() - start_time)) </span>

<span class="k">def</span> <span class="nf">_quit</span><span class="p">():</span>
    <span class="n">root</span><span class="o">.</span><span class="n">quit</span><span class="p">()</span>
    <span class="n">root</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>
    
<span class="k">def</span> <span class="nf">_eigenmode</span><span class="p">():</span>
    <span class="k">global</span> <span class="n">F</span><span class="p">,</span><span class="n">f1</span><span class="p">,</span><span class="n">f2</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="n">w0</span>
    <span class="n">g1</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="n">L</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">f1</span><span class="p">);</span>
    <span class="n">g2</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="n">L</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">f2</span><span class="p">);</span>
    <span class="n">g</span><span class="o">=</span><span class="n">g1</span><span class="o">*</span><span class="n">g2</span>
    <span class="n">z1</span><span class="o">=</span><span class="n">L</span><span class="o">*</span><span class="n">g2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">g1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">g1</span><span class="o">+</span><span class="n">g2</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">g1</span><span class="o">*</span><span class="n">g2</span><span class="p">);</span>
    <span class="n">z2</span><span class="o">=</span><span class="n">L</span><span class="o">-</span><span class="n">z1</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">g</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">):</span>
        <span class="n">w0</span><span class="o">=</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">wavelength</span><span class="o">*</span><span class="n">L</span><span class="o">/</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">g1</span><span class="o">*</span><span class="n">g2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">g1</span><span class="o">*</span><span class="n">g2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">g1</span><span class="o">+</span><span class="n">g2</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">g1</span><span class="o">*</span><span class="n">g2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.25</span><span class="p">;</span>
    <span class="n">mode_m</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">order_m</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
    <span class="n">mode_n</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">order_n</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
    <span class="n">F</span><span class="o">=</span><span class="n">GaussHermite</span><span class="p">(</span><span class="n">mode_m</span><span class="p">,</span><span class="n">mode_n</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">w0</span><span class="p">,</span><span class="n">F</span><span class="p">);</span>
    <span class="c1">#F=GaussLaguerre(mode_m,mode_n,1,w0,F);</span>
    <span class="n">F</span><span class="o">=</span><span class="n">Forvard</span><span class="p">(</span><span class="n">z2</span><span class="p">,</span><span class="n">F</span><span class="p">);</span>

<span class="n">frame1</span><span class="o">=</span><span class="n">Frame</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
<span class="n">frame1</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="n">Tk</span><span class="o">.</span><span class="n">BOTTOM</span><span class="p">)</span>
<span class="n">frame2</span><span class="o">=</span><span class="n">Frame</span><span class="p">(</span><span class="n">frame1</span><span class="p">)</span>
<span class="n">frame2</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="n">Tk</span><span class="o">.</span><span class="n">BOTTOM</span><span class="p">)</span>
<span class="n">frame3</span><span class="o">=</span><span class="n">Frame</span><span class="p">(</span><span class="n">frame2</span><span class="p">)</span>
<span class="n">frame3</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="n">Tk</span><span class="o">.</span><span class="n">BOTTOM</span><span class="p">)</span>
<span class="n">frame4</span><span class="o">=</span><span class="n">Frame</span><span class="p">(</span><span class="n">frame3</span><span class="p">)</span>
<span class="n">frame4</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="n">Tk</span><span class="o">.</span><span class="n">BOTTOM</span><span class="p">)</span>
<span class="n">frame5</span><span class="o">=</span><span class="n">Frame</span><span class="p">(</span><span class="n">frame4</span><span class="p">)</span>
<span class="n">frame5</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="n">Tk</span><span class="o">.</span><span class="n">BOTTOM</span><span class="p">)</span>
<span class="n">frame6</span><span class="o">=</span><span class="n">Frame</span><span class="p">(</span><span class="n">frame5</span><span class="p">)</span>
<span class="n">frame6</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="n">Tk</span><span class="o">.</span><span class="n">BOTTOM</span><span class="p">)</span>
<span class="n">frame7</span><span class="o">=</span><span class="n">Frame</span><span class="p">(</span><span class="n">frame6</span><span class="p">)</span>
<span class="n">frame7</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="n">Tk</span><span class="o">.</span><span class="n">BOTTOM</span><span class="p">)</span>

<span class="n">Label</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="n">v</span><span class="p">)</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="n">Tk</span><span class="o">.</span><span class="n">LEFT</span><span class="p">)</span>

<span class="n">scalexwire</span> <span class="o">=</span> <span class="n">Tk</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">frame1</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;x-wire position [mm]&#39;</span><span class="p">,</span> <span class="n">length</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">from_</span><span class="o">=-</span><span class="n">size</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="n">mm</span><span class="p">,</span> <span class="n">to</span><span class="o">=</span><span class="n">size</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="n">mm</span><span class="p">,</span> <span class="n">resolution</span> <span class="o">=</span> <span class="mf">0.001</span><span class="p">)</span>
<span class="n">scalexwire</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span> <span class="o">=</span> <span class="n">Tk</span><span class="o">.</span><span class="n">LEFT</span><span class="p">)</span>
<span class="n">scalexwire</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xwire</span><span class="o">/</span><span class="n">mm</span><span class="p">)</span>

<span class="n">scaleywire</span> <span class="o">=</span> <span class="n">Tk</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">frame1</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;y-wire position [mm]&#39;</span><span class="p">,</span> <span class="n">length</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">from_</span><span class="o">=-</span><span class="n">size</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="n">mm</span><span class="p">,</span> <span class="n">to</span><span class="o">=</span><span class="n">size</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="n">mm</span><span class="p">,</span> <span class="n">resolution</span> <span class="o">=</span> <span class="mf">0.001</span><span class="p">)</span>
<span class="n">scaleywire</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span> <span class="o">=</span> <span class="n">Tk</span><span class="o">.</span><span class="n">LEFT</span><span class="p">)</span>
<span class="n">scaleywire</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ywire</span><span class="o">/</span><span class="n">mm</span><span class="p">)</span>

<span class="n">scale_w0</span> <span class="o">=</span> <span class="n">Tk</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">frame2</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;aperture diameter [mm]&#39;</span><span class="p">,</span> <span class="n">length</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">from_</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">to</span><span class="o">=</span><span class="n">size</span><span class="o">/</span><span class="n">mm</span><span class="p">,</span> <span class="n">resolution</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">)</span>
<span class="n">scale_w0</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span> <span class="o">=</span> <span class="n">Tk</span><span class="o">.</span><span class="n">LEFT</span><span class="p">)</span>
<span class="n">scale_w0</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">w0</span><span class="o">/</span><span class="n">mm</span><span class="p">)</span>

<span class="n">scale_Reflect</span> <span class="o">=</span> <span class="n">Tk</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">frame2</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;outcoupler reflection&#39;</span><span class="p">,</span> <span class="n">length</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">from_</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">to</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">resolution</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">)</span>
<span class="n">scale_Reflect</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span> <span class="o">=</span> <span class="n">Tk</span><span class="o">.</span><span class="n">LEFT</span><span class="p">)</span>
<span class="n">scale_Reflect</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">Reflect</span><span class="p">)</span>

<span class="n">scale_f1</span> <span class="o">=</span> <span class="n">Tk</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">frame3</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;mirror M1 radius [cm]&#39;</span><span class="p">,</span> <span class="n">length</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">from_</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">to</span><span class="o">=</span><span class="mf">1000.0</span><span class="p">,</span> <span class="n">resolution</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="n">scale_f1</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span> <span class="o">=</span> <span class="n">Tk</span><span class="o">.</span><span class="n">LEFT</span><span class="p">)</span>
<span class="n">scale_f1</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">f1</span><span class="o">/</span><span class="n">cm</span><span class="p">)</span>

<span class="n">scale_f2</span> <span class="o">=</span> <span class="n">Tk</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">frame3</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;mirror M2 radius [cm]&#39;</span><span class="p">,</span> <span class="n">length</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">from_</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">to</span><span class="o">=</span><span class="mf">1000.0</span><span class="p">,</span> <span class="n">resolution</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="n">scale_f2</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span> <span class="o">=</span> <span class="n">Tk</span><span class="o">.</span><span class="n">LEFT</span><span class="p">)</span>
<span class="n">scale_f2</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">f2</span><span class="o">/</span><span class="n">cm</span><span class="p">)</span>

<span class="n">scale_L</span> <span class="o">=</span> <span class="n">Tk</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">frame4</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;resonator length [cm]&#39;</span><span class="p">,</span> <span class="n">length</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">from_</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">to</span><span class="o">=</span><span class="mf">100.0</span><span class="p">,</span> <span class="n">resolution</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">)</span>
<span class="n">scale_L</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span> <span class="o">=</span> <span class="n">Tk</span><span class="o">.</span><span class="n">LEFT</span><span class="p">)</span>
<span class="n">scale_L</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">L</span><span class="o">/</span><span class="n">cm</span><span class="p">)</span>

<span class="n">scale_gain</span> <span class="o">=</span> <span class="n">Tk</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">frame4</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;gain [cm^-1]&#39;</span><span class="p">,</span> <span class="n">length</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">from_</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">to</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">resolution</span> <span class="o">=</span> <span class="mf">0.0001</span><span class="p">)</span>
<span class="n">scale_gain</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span> <span class="o">=</span> <span class="n">Tk</span><span class="o">.</span><span class="n">LEFT</span><span class="p">)</span>
<span class="n">scale_gain</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">alpha</span><span class="o">*</span><span class="n">cm</span><span class="p">)</span>

<span class="n">scale_tx</span> <span class="o">=</span> <span class="n">Tk</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">frame5</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;mirror M2 x-tilt [mrad]&#39;</span><span class="p">,</span> <span class="n">length</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">from_</span><span class="o">=-</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">to</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">resolution</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="n">scale_tx</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span> <span class="o">=</span> <span class="n">Tk</span><span class="o">.</span><span class="n">LEFT</span><span class="p">)</span>
<span class="n">scale_tx</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">tx</span><span class="o">/</span><span class="n">mrad</span><span class="p">)</span>

<span class="n">scale_ty</span> <span class="o">=</span> <span class="n">Tk</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">frame5</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;mirror M2 y-tilt [mrad]&#39;</span><span class="p">,</span> <span class="n">length</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">from_</span><span class="o">=-</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">to</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">resolution</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="n">scale_ty</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span> <span class="o">=</span> <span class="n">Tk</span><span class="o">.</span><span class="n">LEFT</span><span class="p">)</span>
<span class="n">scale_ty</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ty</span><span class="o">/</span><span class="n">mrad</span><span class="p">)</span>

<span class="n">button_eigenmode</span> <span class="o">=</span> <span class="n">Tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">frame6</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="mi">18</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;eigen mode&#39;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="n">_eigenmode</span><span class="p">)</span>
<span class="n">button_eigenmode</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="n">Tk</span><span class="o">.</span><span class="n">LEFT</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">order_m</span><span class="o">=</span><span class="n">Tk</span><span class="o">.</span><span class="n">Spinbox</span><span class="p">(</span><span class="n">frame6</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">from_</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">to</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">order_m</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="n">Tk</span><span class="o">.</span><span class="n">LEFT</span><span class="p">)</span>

<span class="n">order_n</span><span class="o">=</span><span class="n">Tk</span><span class="o">.</span><span class="n">Spinbox</span><span class="p">(</span><span class="n">frame6</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">from_</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">to</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">order_n</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="n">Tk</span><span class="o">.</span><span class="n">LEFT</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">button_quit</span> <span class="o">=</span> <span class="n">Tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">frame7</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="mi">24</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Quit&#39;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="n">_quit</span><span class="p">)</span>
<span class="n">button_quit</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="n">Tk</span><span class="o">.</span><span class="n">LEFT</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">task</span><span class="p">():</span>
    <span class="n">TheExample</span><span class="p">()</span>
    <span class="n">root</span><span class="o">.</span><span class="n">after</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">task</span><span class="p">)</span>

<span class="n">root</span><span class="o">.</span><span class="n">after</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">task</span><span class="p">)</span>
<span class="n">root</span><span class="o">.</span><span class="n">mainloop</span><span class="p">()</span>


</pre></div>
</div>
</div>
</div>
<div class="section" id="unstable-laser-resonator">
<span id="unstab"></span><h2>Unstable laser resonator.<a class="headerlink" href="#unstable-laser-resonator" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1">#Unstable resonator.</span>
<span class="kn">from</span> <span class="nn">LightPipes</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="n">wavelength</span> <span class="o">=</span> <span class="mi">308</span><span class="o">*</span><span class="n">nm</span>
<span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="o">*</span><span class="n">mm</span>
<span class="n">N</span><span class="o">=</span><span class="mi">100</span>
<span class="n">w</span><span class="o">=</span><span class="mf">5.48</span><span class="o">*</span><span class="n">mm</span>
<span class="n">f1</span><span class="o">=-</span><span class="mi">10</span><span class="o">*</span><span class="n">m</span><span class="p">;</span> <span class="n">f2</span><span class="o">=</span><span class="mi">20</span><span class="o">*</span><span class="n">m</span><span class="p">;</span> <span class="n">L</span><span class="o">=</span><span class="mi">10</span><span class="o">*</span><span class="n">m</span><span class="p">;</span> <span class="n">Isat</span><span class="o">=</span><span class="mf">1.0</span><span class="p">;</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">;</span> <span class="n">Lgain</span><span class="o">=</span><span class="mf">1e4</span><span class="p">;</span>
<span class="n">tx</span><span class="o">=</span><span class="mf">0.0</span><span class="p">;</span> <span class="n">ty</span><span class="o">=</span><span class="mf">0.00000</span><span class="p">;</span>
<span class="n">Nrndtrips</span><span class="o">=</span><span class="mi">20</span>

<span class="n">X</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="n">Y</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="n">SR</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">Nrndtrips</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="n">F</span><span class="o">=</span><span class="n">Begin</span><span class="p">(</span><span class="n">size</span><span class="p">,</span><span class="n">wavelength</span><span class="p">,</span><span class="n">N</span><span class="p">);</span>
<span class="n">F</span><span class="o">=</span><span class="n">RandomIntensity</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">(),</span><span class="mi">1000</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
<span class="n">F</span><span class="o">=</span><span class="n">RandomPhase</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">(),</span><span class="mi">10</span><span class="p">,</span><span class="n">F</span><span class="p">);</span>

<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">Nrndtrips</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
   <span class="n">F</span><span class="o">=</span><span class="n">RectAperture</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">F</span><span class="p">);</span>
   <span class="n">F</span><span class="o">=</span><span class="n">Gain</span><span class="p">(</span><span class="n">Isat</span><span class="p">,</span><span class="n">alpha</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">Lgain</span><span class="p">,</span><span class="n">F</span><span class="p">);</span>
   <span class="n">F</span><span class="o">=</span><span class="n">LensFresnel</span><span class="p">(</span><span class="n">f1</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="n">F</span><span class="p">);</span>
   <span class="n">F</span><span class="o">=</span><span class="n">LensFresnel</span><span class="p">(</span><span class="n">f2</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="n">F</span><span class="p">);</span>
   <span class="n">F</span><span class="o">=</span><span class="n">Tilt</span><span class="p">(</span><span class="n">tx</span><span class="p">,</span><span class="n">ty</span><span class="p">,</span><span class="n">F</span><span class="p">);</span>
   <span class="n">SR</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">=</span><span class="n">Strehl</span><span class="p">(</span><span class="n">F</span><span class="p">);</span>
   <span class="n">F</span><span class="o">=</span><span class="n">Interpol</span><span class="p">(</span><span class="n">size</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">F</span><span class="p">);</span>
   <span class="k">print</span> <span class="p">(</span><span class="s1">&#39;Round trip &#39;</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="s1">&#39; Strehl ratio= &#39;</span><span class="p">,</span><span class="n">SR</span><span class="p">[</span><span class="n">k</span><span class="p">],</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">);</span>
   <span class="n">F2</span><span class="o">=</span><span class="n">RectScreen</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">F</span><span class="p">);</span>
   <span class="n">I</span><span class="o">=</span><span class="n">Intensity</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">F2</span><span class="p">);</span>
   <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">Nrndtrips</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">k</span><span class="p">)</span>
   <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
   <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
   <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
<span class="n">F2</span><span class="o">=</span><span class="n">Convert</span><span class="p">(</span><span class="n">F2</span><span class="p">);</span>
<span class="n">i</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="n">j</span><span class="o">=</span><span class="n">i</span>
<span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">gca</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="n">surf</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="n">rstride</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">cstride</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;rainbow&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Near-field intensity distribution&#39;</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">Nrndtrips</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">SR</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="n">Nrndtrips</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Strehl ratio&#39;</span><span class="p">)</span>

<span class="c1">#Far-field calculation:</span>
<span class="n">z</span><span class="o">=</span><span class="mf">1.0</span><span class="o">*</span><span class="n">m</span><span class="p">;</span> <span class="n">f</span><span class="o">=</span><span class="mf">40.0</span><span class="o">*</span><span class="n">m</span><span class="p">;</span>
<span class="n">ff</span><span class="o">=</span><span class="n">z</span><span class="o">*</span><span class="n">f</span><span class="o">/</span><span class="p">(</span><span class="n">f</span><span class="o">-</span><span class="n">z</span><span class="p">);</span>
<span class="n">F2</span><span class="o">=</span><span class="n">Lens</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">F2</span><span class="p">);</span>
<span class="n">F2</span><span class="o">=</span><span class="n">LensFresnel</span><span class="p">(</span><span class="n">ff</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">F2</span><span class="p">);</span>
<span class="n">F2</span><span class="o">=</span><span class="n">Convert</span><span class="p">(</span><span class="n">F2</span><span class="p">);</span>
<span class="n">I2</span><span class="o">=</span><span class="n">Intensity</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">F2</span><span class="p">);</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">gca</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="n">surf</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">I2</span><span class="p">,</span> <span class="n">rstride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cstride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;rainbow&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Far-field intensity distribution&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="./Examples/Laser/unstable_resonator.py">Source code</a>)</p>
<div class="figure" id="id2">
<img alt="_images/unstable_resonator_00.png" src="_images/unstable_resonator_00.png" />
<p class="caption"><span class="caption-text">(<a class="reference external" href="./Examples/Laser/unstable_resonator_00.png">png</a>, <a class="reference external" href="./Examples/Laser/unstable_resonator_00.hires.png">hires.png</a>, <a class="reference external" href="./Examples/Laser/unstable_resonator_00.pdf">pdf</a>)</span></p>
</div>
<div class="figure" id="id3">
<img alt="_images/unstable_resonator_01.png" src="_images/unstable_resonator_01.png" />
<p class="caption"><span class="caption-text">(<a class="reference external" href="./Examples/Laser/unstable_resonator_01.png">png</a>, <a class="reference external" href="./Examples/Laser/unstable_resonator_01.hires.png">hires.png</a>, <a class="reference external" href="./Examples/Laser/unstable_resonator_01.pdf">pdf</a>)</span></p>
</div>
<div class="figure" id="id4">
<img alt="_images/unstable_resonator_02.png" src="_images/unstable_resonator_02.png" />
<p class="caption"><span class="caption-text">(<a class="reference external" href="./Examples/Laser/unstable_resonator_02.png">png</a>, <a class="reference external" href="./Examples/Laser/unstable_resonator_02.hires.png">hires.png</a>, <a class="reference external" href="./Examples/Laser/unstable_resonator_02.pdf">pdf</a>)</span></p>
</div>
<div class="figure" id="id5">
<img alt="_images/unstable_resonator_03.png" src="_images/unstable_resonator_03.png" />
<p class="caption"><span class="caption-text">(<a class="reference external" href="./Examples/Laser/unstable_resonator_03.png">png</a>, <a class="reference external" href="./Examples/Laser/unstable_resonator_03.hires.png">hires.png</a>, <a class="reference external" href="./Examples/Laser/unstable_resonator_03.pdf">pdf</a>)</span></p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/underconstruction.png" alt="Logo"/>
            </a></p>
<h3><a href="index.html">Table Of Contents</a></h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction.</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation.</a></li>
<li class="toctree-l1"><a class="reference internal" href="support.html">Support.</a></li>
<li class="toctree-l1"><a class="reference internal" href="command-reference.html">Command Reference.</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="interference.html">Interference examples.</a></li>
<li class="toctree-l1"><a class="reference internal" href="besselbeam.html">Non-diffractive Bessel beam.</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Laser examples.</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#laser-simulation-stable-laser-resonator">Laser simulation, stable laser resonator.</a></li>
<li class="toctree-l2"><a class="reference internal" href="#unstable-laser-resonator">Unstable laser resonator.</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="foclens.html">Focus of a lens.</a></li>
<li class="toctree-l1"><a class="reference internal" href="diffraction.html">Diffraction examples.</a></li>
<li class="toctree-l1"><a class="reference internal" href="zernike.html">Zernike aberration.</a></li>
<li class="toctree-l1"><a class="reference internal" href="phaserecovery.html">Phase recovery.</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="computerprac.html">Computer practical.</a></li>
</ul>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/laser.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div> 

    <div class="footer" role="contentinfo">
        &#169; Copyright 2017, Fred van Goor.
      Last updated on Apr 05, 2017.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.5.3.
    </div>
  </body>
</html>