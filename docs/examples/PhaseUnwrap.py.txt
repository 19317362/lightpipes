#Test LPPhaseUnwrap
import LightPipes
import matplotlib.pyplot as plt

import numpy as np

m=1;
mm=1e-3*m;
cm=1e-2*m;
nm=1e-9*m;

size=10*mm;
wavelength=1000*nm;
N=60;
f=5*m;
K=1;
LP=LightPipes.Init()
F=LP.Begin(size,wavelength,N);
F=LP.Lens(f,0,0,F);
Phase=LP.Phase(F);

plt.subplot(1,2,1);
plt.imshow(Phase);

plt.title('Phase');
#Phase=LP.PhaseUnwrap(Phase);
Phase=np.unwrap(np.unwrap(Phase,np.pi,0),np.pi,1);
plt.subplot(1,2,2);
plt.imshow(Phase);

plt.title('Unwrapped phase');
plt.show()
